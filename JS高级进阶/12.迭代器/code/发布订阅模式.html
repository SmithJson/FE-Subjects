<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        var eventObj = {
            // 订阅者列表
            list: {},
            // 添加订阅
            listen: function (key, fn) {
                if (!this.list[key]) {
                    this.list[key] = [];
                }

                typeof fn === 'function' && this.list[key].push(fn);
            },
            // 发布信息
            trigger: function () {
                var key  = arguments[0] || this;
                var args = [].slice.call(arguments, 1);
                // 订阅事件
                var cbs = this.list[key];

                if (cbs) {
                    for (var i = 0; i < cbs.length; i++) {
                        var cb = cbs[i];

                        cb.apply(this, args);
                    }
                }
            },
            // 取消订阅
            removeListen: function (key, fn) {
                var cbs = this.list[key];

                if (!cbs) return;

                var index = cbs.indexOf(fn);

                cbs.splice(index, 1);
            },
        };

        var ajaxObj = Object.create(eventObj);

        ajaxObj.listen('success', function (data) {
            console.log(data);
        });

        setTimeout(function () {
            ajaxObj.trigger('success', { name: 'zhangl' });
        }, 1000);





        var fn1 = function (size, num) {
            console.log('小红', size, num);
        };

        eventObj.listen('red', fn1);
        eventObj.listen('red', function (size, num) {
            console.log('小白', size, num);
        });
        eventObj.listen('red', function (size, num) {
            console.log('小绿', size, num);
        });

        eventObj.listen('blue', function (size, num) {
            console.log('小灰', size, num);
        });
        eventObj.listen('blue', function (size, num) {
            console.log('小粉', size, num);
        });
        eventObj.listen('blue', function (size, num) {
            console.log('小黑', size, num);
        });

        eventObj.removeListen('red', fn1);
        eventObj.trigger('red', 45, 30);
        eventObj.trigger('blue', 45, 30);
    </script>
</body>
</html>