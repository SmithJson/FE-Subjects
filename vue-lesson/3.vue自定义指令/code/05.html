<!--
 * @Author: zhangl
 * @Date: 2020-02-20 00:52:52
 * @LastEditors: zhangl
 * @LastEditTime: 2020-02-20 01:45:08
 * @GitHub: https://github.com/SmithJson
 * @FilePath: /FE-Subjects/vue-lesson/3.vue自定义指令/code/05.html
 * @Description: Vue 自定义指令
 -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="root">
        <button @click="handleChangeMsg('zl')">修改</button>
        <p v-hello>{{msg}}</p>
        <p v-world:key="test.value">{{age}}</p>
        <input type="text" v-model="age" v-focus />
    </div>
    <script src="https://cdn.bootcss.com/vue/2.6.10/vue.js"></script>
    <script>
        // vue 全局自定义指令
        Vue.directive('hello', {
            bind(el, binding) {
                // el：绑定指令的元素
                // binding：指令传入的数据
                console.log('========= 指令第一次绑定到元素上时调用，只调用一次，可执行初始化操作 =========');
                console.log('el：', el);
                console.log('binding:', binding);
            },
            inserted(el, binding) {
                console.log('========= 被绑定元素插入到DOM中时调用 =========');
                console.log('el：', el);
                console.log('binding:', binding);
            },
            update(el, binding) {
                console.log('========= 被绑定元素所在模板更新时调用, 模板还没更新完成 =========');
                console.log('el：', el);
                console.log('binding:', binding);
            },
            componentUpdated(el, binding) {
                console.log('========= 被绑定元素所在模板完成一次更新周期时调用 =========');
                console.log('el：', el);
                console.log('binding:', binding);
            },
            unbind(el, binding) {
                console.log('========= 指令与元素解绑时调用，只调用一次 =========');
                console.log('el：', el);
                console.log('binding:', binding);
            }
        });

        Vue.directive('world', function (el, binding) { // 第二个参数为函数，只触发 bind、update 周期函数
            console.log('el：', el);
            console.log('binding:', binding);
            // 获取动态参数名
            console.log(binding.arg);
            // 获取动态参数值
            console.log(binding.value);
        });

        var vm = new Vue({
            el: '#root',
            data: {
                msg: 'zhangl',
                age: 18,
                test: {
                    value: 'test',
                },
                gender: 'female',
            },
            methods: {
                handleChangeMsg(value) {
                    this.msg = value;
                },
            },
            directives: { // 局部自定义指令
                focus: {
                    bind(el, binding) {
                        // 此时数据还没有渲染
                    },
                    inserted(el, binding) {
                        el.focus();
                    },
                },
            },
        });
    </script>
</body>
</html>
